# Excel文本替换工具使用说明

## 功能介绍
这个工具可以批量替换Excel文件（.xlsx和.xls格式）中的文本内容，保持原有的格式和样式不变。

## 安装依赖
```bash
pip install -r requirements.txt
```

## 使用方法

### 1. 配置替换规则
打开 `excel_text_replacer.py` 文件，找到配置区域：

```python
# ==================== 配置区域 ====================
REPLACEMENT_CONFIG = {
    "人才": "能士",
    # 可以添加更多替换规则，格式为 "原文本": "新文本"
    # "示例原文": "示例新文",
    # "另一个原文": "另一个新文",
}
```

在这里修改你需要的替换规则。例如：
- `"人才": "能士"` 表示将所有的"人才"替换为"能士"
- 可以添加多个替换规则

### 2. 运行脚本

#### 处理当前目录下的所有Excel文件：
```bash
python excel_text_replacer.py
```

#### 处理指定目录下的所有Excel文件：
```bash
python excel_text_replacer.py /path/to/excel/files
```

#### 处理单个Excel文件：
```bash
python excel_text_replacer.py /path/to/file.xlsx
```

## 输出说明

### 文件输出
- 原文件不会被修改
- 处理后的文件会保存为 `原文件名_replaced.xlsx` 格式
- 例如：`config.xlsx` → `config_replaced.xlsx`

### 控制台输出
脚本会显示：
1. 当前的替换配置
2. 找到的Excel文件列表
3. 每个文件的处理进度
4. 每个工作表的替换次数
5. 最终的处理总结

### 处理总结包含：
- 处理时间
- 处理文件数量
- 总替换次数
- 每个替换规则的具体替换次数
- 所有处理文件的详细信息

## 示例

假设你有一个Excel文件包含以下内容：
- "人才管理系统"
- "优秀人才培养"
- "人才能力评估"

配置替换规则为 `"人才": "能士"` 后，运行脚本，结果将变为：
- "能士管理系统"
- "优秀能士培养"
- "能士能力评估"

## 注意事项

1. **备份重要文件**：虽然脚本不会覆盖原文件，但建议在处理重要文件前先备份
2. **文件格式**：支持 .xlsx 和 .xls 格式
3. **样式保持**：脚本会保持原有的字体、颜色、边框等格式
4. **大小写敏感**：替换是大小写敏感的
5. **全词匹配**：会替换包含目标文本的所有位置，不区分是否为完整单词

## 故障排除

### 常见错误：
1. **ModuleNotFoundError: No module named 'openpyxl'**
   - 解决方案：运行 `pip install openpyxl`

2. **文件被占用**
   - 解决方案：确保Excel文件没有在其他程序中打开

3. **权限错误**
   - 解决方案：确保对目标目录有写入权限

### 如果遇到其他问题：
- 检查文件路径是否正确
- 确保Excel文件没有损坏
- 查看控制台输出的错误信息
